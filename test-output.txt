
> vite_react_shadcn_ts@0.0.0 test
> jest src/types/__tests__/messaging.test.ts

FAIL src/types/__tests__/messaging.test.ts
  Messaging Type Utilities
    validateFile
      ΓêÜ should accept valid image files (5 ms)
      ΓêÜ should accept valid document files (2 ms)
      ΓêÜ should accept valid video files (1 ms)
      ΓêÜ should reject files larger than MAX_ATTACHMENT_SIZE (504 ms)
      ΓêÜ should reject disallowed file types (1 ms)
      ΓêÜ should handle edge case: exactly MAX_ATTACHMENT_SIZE (868 ms)
    formatFileSize
      ΓêÜ should format bytes correctly (2 ms)
      ΓêÜ should handle zero bytes
      ΓêÜ should round to one decimal place (2 ms)
    getAttachmentType
      ΓêÜ should identify image types (2 ms)
      ΓêÜ should identify video types (1 ms)
      ΓêÜ should identify document types (1 ms)
      ΓêÜ should return "other" for unknown types
    getOtherUser
      ΓêÜ should return participant_2 when current user is participant_1 (1 ms)
      ΓêÜ should return participant_1 when current user is participant_2 (1 ms)
      ΓêÜ should return null when participants not loaded
    isOwnMessage
      ΓêÜ should return true when user is sender (1 ms)
      ΓêÜ should return false when user is not sender
    hasAttachment
      ΓêÜ should return true when message has attachment_url
      ΓêÜ should return false when message has no attachment_url
      ΓêÜ should return false when attachment_url is undefined (1 ms)
    generateOptimisticId
      ΓêÜ should generate unique IDs
      ├ù should generate IDs with correct prefix (2 ms)
      ├ù should generate IDs with timestamp and random component (1 ms)
    Constants
      ΓêÜ should have correct MAX_MESSAGE_LENGTH (1 ms)
      ΓêÜ should have correct MAX_ATTACHMENT_SIZE (10MB)

  ΓùÅ Messaging Type Utilities ΓÇ║ generateOptimisticId ΓÇ║ should generate IDs with correct prefix

    expect(received).toMatch(expected)

    Expected pattern: /^optimistic-/
    Received string:  "optimistic_1762209591944_zuzp8zvie"

      230 |             const id = generateOptimisticId();
      231 |
    > 232 |             expect(id).toMatch(/^optimistic-/);
          |                        ^
      233 |         });
      234 |
      235 |         it('should generate IDs with timestamp and random component', () => {

      at Object.<anonymous> (src/types/__tests__/messaging.test.ts:232:24)

  ΓùÅ Messaging Type Utilities ΓÇ║ generateOptimisticId ΓÇ║ should generate IDs with timestamp and random component

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: 1

      237 |             const parts = id.split('-');
      238 |
    > 239 |             expect(parts.length).toBe(3); // 'optimistic', timestamp, random
          |                                  ^
      240 |             expect(Number(parts[1])).toBeGreaterThan(0); // Valid timestamp
      241 |             expect(parts[2].length).toBeGreaterThan(0); // Has random component
      242 |         });

      at Object.<anonymous> (src/types/__tests__/messaging.test.ts:239:34)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 24 passed, 26 total
Snapshots:   0 total
Time:        4.287 s
Ran all test suites matching /src\\types\\__tests__\\messaging.test.ts/i.
